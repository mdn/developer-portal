{% extends "base.html" %}
{% load static %}
{% load app_filters %}
{% load wagtailcore_tags %}

{% block body_class %}topic{% endblock %}

{% block header %}
  {% include "header.html" %}
  {% include "utils/accent-color.html" with color=page.color_value %}
{% endblock %}

{% block content %}
<main class="has-header has-footer">
  <div class="base-grid">
    <section class="section-full">
      {% include "organisms/pattern-bg-header.html" with title=page.title description=page.description icon=page.icon %}
    </section>
    {% if page.featured %}
      <section>
        {% include "organisms/featured.html" with featured=page.featured featured_count=page.featured_count %}
      </section>
    {% endif %}
    {% if page.get_started %}
      <section class="section-full section-background section-full-bg">
        {% include "organisms/get-started.html" %}
      </section>
    {% endif %}
    {% with subtopics=self.subtopics %}
      {% if subtopics %}
        <section class="section-full">
          {% include "organisms/topic-links.html" with topics=subtopics pagetheme="topic" %}
        </section>
      {% endif %}
    {% endwith %}
    {% if page.articles.all %}
      <section>
        <div class="section-header">
          <h2>Latest articles</h2>
          <a href="">See more</a>
        </div>
        {% if page.articles.count == 1 %}
          {# a single article is rendered full width #}
          <div>
            {% with page.articles.all.0 as article %}
              {% include "molecules/cards/card.html" with resource=article show_author=True full_width=True %}
            {% endwith %}
          </div>
        {% else %}
          {# 2 or 3 are rendered side-by-side #}
          <div class="card-container {% if page.articles.count == 2 %}card-container-2-wide{% endif %}">
            {% for article in page.articles.all|slice:":3" %}
              {% include "molecules/cards/card.html" with resource=article show_author=True %}
            {% endfor %}
          </div>
        {% endif %}
      </section>
    {% endif %}
    {% if page.people.all %}
    <section>
      <div class="section-header">
        <h2>People</h2>
        <a href="">See more</a>
      </div>
      {% if page.people.count == 1 %}
        {# a single person is rendered full width #}
        <div>
          {% with page.people.all.0 as person %}
            {% include "molecules/item-person.html" with person=person.person type="person" full_width=True%}
          {% endwith %}
        </div>
      {% else %}
        {# 2 or 3 are rendered side-by-side #}
        <div class="card-container {% if page.people.count == 2 %}card-container-2-wide{% endif %}">
          {% for person in page.people.all|slice:":3" %}
            {% include "molecules/item-person.html" with person=person.person type="person"  full_width=False%}
          {% endfor %}
        </div>
        </div>
      {% endif %}
    </section>
    {% endif %}
    {% if page.events.all %}
    <section class="section-full section-full-bg">
      <div class="section-full-container">
        <div class="section-header">
          <h2>Upcoming events</h2>
          <a href="/events">See more</a>
        </div>
        <div>
        {% for event in page.events.all|slice:":3" %}
          {% if forloop.counter == 1 %}
            {% include "molecules/cards/card.html" with resource=event featured=True %}
          {% else %}
            {% include "molecules/cards/card.html" with resource=event %}
          {% endif %}
        {% endfor %}
        </div>
      </div>
    </section>
    {% endif %}
    <section class="section-full">
      {% include "organisms/newsletter-signup.html" %}
    </section>
  </div>
</main>
{% endblock content %}
