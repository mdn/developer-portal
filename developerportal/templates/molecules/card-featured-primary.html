{% load static %}
{% load wagtailcore_tags %}
{% load wagtailimages_tags %}

{% if resource.card_image %}
  {% image resource.card_image width-1024 as img %}
{% else %}
  {% if resource.image.url %}
    {% image resource.image width-1024 as img %}
  {% else %}
    {% if block_type == "video" %}
      {% static "img/placeholders/video-16-9.jpg" as fallback_url %}
    {% elif block_type == "event" %}
      {% static "img/placeholders/event-16-9.jpg" as fallback_url %}
    {% else %}
      {% static "img/placeholders/article-16-9.jpg" as fallback_url %}
    {% endif %}
  {% endif %}
{% endif %}


<div class="mzp-l-card-full">
  <div class="mzp-c-card devportal-card-x-large devportal-has-aspect-3-1">
    {% if external_page %}
    <a href="{{ resource.url }}" class="mzp-c-card-block-link" data-type="external_page" target="_blank" rel="nofollow noopener">
    {% else %}
    <a href="{% pageurl resource %}" class="mzp-c-card-block-link" data-type="{{ resource.resource_type }}">
    {% endif %}
      <div class="mzp-c-card-media-wrapper">
          <div class="lazy-image-container">
            <img class="mzp-c-card-image" src="{% firstof img.url fallback_url %}" alt="">
          </div>
      </div>
      <div class="mzp-c-card-content">
        <div class="mzp-c-card-tag">{{resource.primary_topic|default:"Featured"}}</div>
        <h2 class="mzp-c-card-title">
          <span>
            {% firstof resource.card_title resource.title %}
          </span>
          {% if external_page or resource.is_external %}
          <span class="no-wrap">&#65279;<span class="icon icon-external">
              {% include "atoms/icons/external.svg" %}
          </span></span>
          {% endif %}
        </h2>
        <div class="mzp-c-card-desc">
          {% if resource.card_description %}
            <p>{{ resource.card_description }}</p>
          {% else %}
            {{ resource.description | richtext }}
          {% endif %}
        </div>
      </div>
    </a>
  </div>
</div>
